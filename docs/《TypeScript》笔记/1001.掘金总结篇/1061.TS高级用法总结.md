---
title: TSé«˜çº§ç”¨æ³•æ€»ç»“
date: 2021-11-20 16:46:20
permalink: /pages/8e909e/
categories:
  - ã€ŠTypeScriptã€‹ç¬”è®°
  - æ˜é‡‘æ€»ç»“ç¯‡
tags:
  - 
---

# TSé«˜çº§ç”¨æ³•æ€»ç»“ã€ŠäºŒã€‹

**æœ¬æ–‡ä¸»è¦å†…å®¹**ï¼štypeofã€æ¡ä»¶ç±»å‹

æœ¬æ–‡é˜…è¯»æ—¶é—´å¤§çº¦ä¸º8åˆ†é’Ÿï¼Œè¯·å¬ç¬”è€…å¨“å¨“é“æ¥ã€‚

## typeof ç±»å‹è¿ç®—ç¬¦

è¯·æ³¨æ„ type æ˜¯ç±»å‹åˆ«å

```ts
// Prints "string"
console.log(typeof "Hello world");
```

ä½¿ç”¨ typeof ä¼šè‡ªåŠ¨è¿”å› ç±»å‹ï¼Œè¿™å¯¹äºåŸºæœ¬ç±»å‹å¹¶ä¸ååˆ†æœ‰ç”¨ï¼Œä½†æ˜¯ç»“åˆå…¶ä»–ç±»å‹æ“ä½œç¬¦ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ typeof æ–¹ä¾¿åœ°è¡¨ç¤ºè®¸å¤šæ¨¡å¼ã€‚

```ts
function f() {
  return { x: 10, y: 3 };
}
type P = ReturnType<typeof f>;
// type P = {
//     x: number;
//     y: number;
// }
```

æˆ–è€…è¿˜å¯ä»¥é€šè¿‡ ç´¢å¼•

```ts
type Person = { age: number; name: string; alive: boolean };
type Age = Person["age"];
// type Age = number
```

ä½¿ç”¨ä»»æ„ç±»å‹è¿›è¡Œç´¢å¼•çš„å¦ä¸€ä¸ªç¤ºä¾‹æ˜¯ä½¿ç”¨ T æ¥è·å–æ•°ç»„å…ƒç´ çš„ç±»å‹ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå’Œ typeof ç»“åˆèµ·æ¥ï¼Œæ–¹ä¾¿åœ°æ•è·æ•°ç»„æ–‡å­—çš„å…ƒç´ ç±»å‹:

```ts
const MyArray = [
  { name: "Alice", age: 15 },
  { name: "Bob", age: 23 },
  { name: "Eve", age: 38 },
];

type Person = typeof MyArray[T];    
// type Person = {
//     name: string;
//     age: number;
// }

type Age = typeof MyArray[T]["age"]; 
// type Age = number

// Or
type Age2 = Person["age"];
// type Age2 = number
```

## æ¡ä»¶ç±»å‹

åœ¨å¤§å¤šæ•°æœ‰ç”¨çš„ç¨‹åºçš„æ ¸å¿ƒï¼Œæˆ‘ä»¬å¿…é¡»æ ¹æ®è¾“å…¥åšå‡ºå†³å®šã€‚ç¨‹åºæ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œä½†æ˜¯è€ƒè™‘åˆ°å€¼å¯ä»¥å¾ˆå®¹æ˜“åœ°åçœï¼Œè¿™äº›å†³å®šä¹Ÿæ˜¯åŸºäºè¾“å…¥çš„ç±»å‹ã€‚æ¡ä»¶ç±»å‹å¸®åŠ©æè¿°è¾“å…¥å’Œè¾“å‡ºç±»å‹ä¹‹é—´çš„å…³ç³»ã€‚

```ts
interface Animal {
  live(): void;
}
interface Dog extends Animal {
  woof(): void;
}

type Example1 = Dog extends Animal ? number : string;
// Dog æ˜¯ç»§æ‰¿è‡ª Animal 
// type Example1 = number
 
type Example2 = RegExp extends Animal ? number : string;
// type Example2 = string
```

å†å¦‚æœ‰ä¸ªé‡è½½å‡½æ•°ï¼Œçœ‹çœ‹å’±ä¹ˆæ€ä¹ˆé€šè¿‡è¿™ä¸ªæ¡ä»¶ç±»å‹å»æ”¹å†™ã€‚createLabel çš„é‡è½½æè¿°äº†ä¸€ä¸ªåŸºäºè¾“å…¥ç±»å‹è¿›è¡Œé€‰æ‹©çš„ JavaScript å‡½æ•°

```js
interface IdLabel {
  id: number /* some fields */;
}
interface NameLabel {
  name: string /* other fields */;
}
 
function createLabel(id: number): IdLabel;
function createLabel(name: string): NameLabel;
function createLabel(nameOrId: string | number): IdLabel | NameLabel;
function createLabel(nameOrId: string | number): IdLabel | NameLabel {
  throw "unimplemented";
}
```
æ”¹å†™

```ts
type NameOrId<T extends number | string> = T extends number
  ? IdLabel
  : NameLabel;

// æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥æ¡ä»¶ç±»å‹å°†é‡è½½ç®€åŒ–ä¸ºå•ä¸ªå‡½æ•°ï¼Œè€Œä¸éœ€è¦é‡è½½
function createLabel<T extends number | string>(idOrName: T): NameOrId<T> {
  throw "unimplemented";
}
let a = createLabel("typescript");
// let a: NameLabel
let b = createLabel(2.8);
// let b: IdLabel
let c = createLabel(Math.random() ? "hello" : 42);
// let c: NameLabel | IdLabel
```

## æ€»ç»“

æ¡ä»¶ç±»å‹è¿™ä¸€éƒ¨åˆ†ï¼Œè¿˜æœ‰ä¸€äº›æ›´é«˜çº§çš„ç”¨æ³•ï¼Œä½†ç¬”è€…è®¤ä¸ºï¼Œå¯ä»¥å…ˆæŠŠè¿™ç¯‡æ–‡ç« çš„å†…å®¹å­¦æ‡‚ï¼Œå†å»å­¦æ›´é«˜çº§çš„ã€‚è™½ç„¶å¹³å¸¸å¯èƒ½ç”¨ä¸åˆ°ï¼Œä½†æ˜¯å½“ä½ é˜…è¯»æºç çš„æ—¶å€™ï¼Œä½ å°±ä¼šä½“ä¼šç±»å‹çº¦æŸå¸¦æ¥çš„å¥½å¤„ï¼

é˜…è¯» Vue3 æºç ï¼Œå¦‚æœä¸çŸ¥é“ ts çš„é«˜çº§ç”¨æ³•ï¼Œä½ å¯èƒ½ä¼šåˆ«ç»•æ™•ï¼›ä½†æ˜¯ï¼Œå¦‚æœä½ æ˜¯åˆæ¬¡é˜…è¯»æºç ï¼Œå»ºè®®åœ¨ç¤¾åŒºå†…æ‰¾ä¸€ä¸ªâ€œç®€å•â€ç‰ˆæœ¬å­¦ä¹ ï¼Œå’³å’³ï¼

ğŸ‘ğŸ‘ğŸ‘

æ¨èæºç é˜…è¯»ä» mini-vue å¼€å§‹ï¼š[gitHub ä»“åº“](https://github.com/cuixiaorui/mini-vue)ï¼Œå®ç°äº†æœ€ç®€çš„ Vue æ¨¡å‹ï¼
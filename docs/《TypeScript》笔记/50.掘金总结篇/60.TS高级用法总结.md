---
title: TSé«˜çº§ç”¨æ³•æ€»ç»“
date: 2021-11-19 13:47:13
permalink: /pages/da71ef/
categories:
  - ã€ŠTypeScriptã€‹ç¬”è®°
  - æ˜é‡‘æ€»ç»“ç¯‡
tags:
  - 
---

# TSé«˜çº§ç”¨æ³•æ€»ç»“ã€Šä¸€ã€‹

**æœ¬æ–‡ä¸»è¦å†…å®¹**ï¼šåœ¨ function ä¸­ä½¿ç”¨æ³›å‹ã€åœ¨ class ä¸­ä½¿ç”¨æ³›å‹å’Œextends keyof çš„ä½¿ç”¨

æœ¬æ–‡é˜…è¯»æ—¶é—´å¤§çº¦ä¸º8åˆ†é’Ÿï¼Œè¯·å¬ç¬”è€…å¨“å¨“é“æ¥ã€‚

## åœ¨ function ä¸­ä½¿ç”¨æ³›å‹

æ³›å‹å¯ä»¥ç†è§£ä¸ºæ˜¯å‡½æ•°çš„å‚æ•°

```ts
function identity(arg: number): number {
  return arg;
}
```

ä¸Šè¿°ä¾‹å­ï¼Œè¡¨ç¤ºä¼ å…¥å‚æ•°å’Œè¿”å›å€¼éƒ½å¿…é¡»æ˜¯ number ç±»å‹ï¼›å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ anyï¼Œä½¿ç”¨ any æ—¶ä¸¢å¤±äº† ts çš„åŠŸæ•ˆã€‚åœ¨æ—¥å¸¸çš„å¼€å‘é¡¹ç›®ä¸­ï¼Œå»ºè®®å°‘ç”¨ any ç±»å‹ã€‚

**æ³›å‹å¸¸ç”¨çš„å†™æ³•**

```ts
function identity<Type>(arg: Type): Type {
  return arg;
}

// ä¸Šé¢å°±æ˜¯ Type å°±æ˜¯ string ç±»å‹
let output = identity("myString");
```

å¦‚æœæ­¤æ—¶ arg æ˜¯ä¸ªæ•°ç»„ï¼Œä¸Šé¢ identity æ–¹æ³•å°±éœ€è¦æ”¹å†™

```ts
function loggingIdentity<Type>(arg: Type): Type {
  console.log(arg.length);
  // Property 'length' does not exist on type 'Type'.
  return arg;
}

// === æ”¹å†™æˆ Type[] æ¨èä½¿ç”¨ ğŸ‘ğŸ‘ğŸ‘ ===
function loggingIdentity<Type>(arg: Type[]): Type[] {
  console.log(arg.length);
  return arg;
}

// === ä¹Ÿå¯ä»¥ Array<Type> ===
function loggingIdentity<Type>(arg: Array<Type>): Array<Type> {
  console.log(arg.length); // Array has a .length, so no more error
  return arg;
}
```

**å‡½æ•°å­—é¢é‡çš„å½¢å¼å®šä¹‰æ³›å‹**

```ts
function identity<Type>(arg: Type): Type {
  return arg;
}
 
let myIdentity: { <Type>(arg: Type): Type } = identity;
```

ä¸Šè¿°æ–¹å¼æ˜¯é€šè¿‡å­—é¢é‡çš„å½¢å¼å®šä¹‰æ³›å‹ï¼Œç¬”è€…è®¤ä¸ºå¯é˜…è¯»æ€§ä¸å¼ºï¼Œå’±ä»¬å¯ä»¥ç¨å¾®æ”¹é€ ä½¿ç”¨æ¥å£çš„æ–¹å¼ã€‚

```ts
interface GenericIdentityFn<Type> {
 (arg: Type): Type;
}
 
type cGenericIdentityFn = GenericIdentityFn <number>
 
let myIdentity: cGenericIdentityFn = (num:number) => return 12;
```

å’±ä»¬å®šä¹‰äº†ä¸€ä¸ª GenericIdentityFn æ¥å£ï¼Œå†ä½¿ç”¨ç±»å‹åˆ«å type å®šä¹‰äº†ä¸€ä¸ª number ç±»å‹çš„ GenericIdentityFnï¼Œç„¶åå†å®ç° myIdentityã€‚

è™½ç„¶ï¼Œå¾ˆç»•ä½†æ˜¯å¥½å¤„å°±æ˜¯å½“é¡¹ç›®å¤§çš„æ—¶å€™ï¼Œæ‰€æœ‰æ¥æºçš„ç±»å‹éƒ½å¯çŸ¥é“ã€‚Vue3 æºç ä¸­çš„ ts æ¯”è¿™è¿˜ç»•ï¼Œç›¸ä¿¡çœ‹è¿‡çš„åŒå­¦éƒ½æœ‰æ·±åˆ»çš„å°è±¡ã€‚

## åœ¨ class ä¸­ä½¿ç”¨æ³›å‹

**ä½¿ç”¨ç¤ºä¾‹**

```ts
class GenericNumber<NumType> {
  zeroValue: NumType;
  add: (x: NumType, y: NumType) => NumType;
}
 
let myGenericNumber = new GenericNumber<number>();
  myGenericNumber.zeroValue = 0;
  myGenericNumber.add = function (x, y) {
  return x + y;
};

// æˆ–è€…
let stringNumeric = new GenericNumber<string>();
  stringNumeric.zeroValue = "";
  stringNumeric.add = function (x, y) {
  return x + y;
};
```

é€šè¿‡æ³›å‹ï¼Œä¸€ä¸ªç±»å¯ä»¥ç”Ÿæˆå¤šç§ç±»å‹çš„å®ä¾‹

## extends & keyof

**extends**

ä¹‹å‰æˆ‘ä»¬å¤„ç†ä¸‹é¢è¿™ç§æ–¹å¼çš„æ—¶å€™ï¼Œæ˜¯è®© arg:Type -> arg:Type[]

```ts
function loggingIdentity<Type>(arg: Type): Type {
  console.log(arg.length);
  // Property 'length' does not exist on type 'Type'.
  return arg;
}
```

ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»§æ‰¿çš„æ–¹å¼æ¥å¦¥å–„å¤„ç†ä¸Šè¿°çš„é—®é¢˜

```ts
interface Lengthwise {
  length: number;
}
 
function loggingIdentity<Type extends Lengthwise>(arg: Type): Type {
  console.log(arg.length); // Now we know it has a .length property, so no more error
  return arg;
}

loggingIdentity({ length: 10, value: 3 });
```

**keyof**

å¯ä»¥å£°æ˜å—å…¶ä»–ç±»å‹å‚æ•°çº¦æŸçš„ç±»å‹å‚æ•°ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œæˆ‘ä»¬å¸Œæœ›ä»ç»™å®šåç§°çš„å¯¹è±¡è·å–ä¸€ä¸ªå±æ€§ã€‚æˆ‘ä»¬å¸Œæœ›ç¡®ä¿æˆ‘ä»¬ä¸ä¼šæ„å¤–åœ°æŠ“å– obj ä¸Šä¸å­˜åœ¨çš„å±æ€§ï¼Œå› æ­¤æˆ‘ä»¬å°†åœ¨ä¸¤ç§ç±»å‹ä¹‹é—´è®¾ç½®ä¸€ä¸ªçº¦æŸ

```ts
// Key extends keyof Type è¡¨ç¤º ç¬¬äºŒä¸ªå‚æ•° ä¸€å®šæ˜¯ Type ä¸­çš„ key
// å¹¶ä¸”è¿™æ˜¯è¿”å›ä¸€ä¸ªè”åˆç±»å‹ union
function getProperty<Type, Key extends keyof Type>(obj: Type, key: Key) {
  return obj[key];
}
 
let x = { a: 1, b: 2, c: 3, d: 4 };
 
getProperty(x, "a");
getProperty(x, "m");
// Argument of type '"m"' is not assignable to parameter of type '"a" | "b" | "c" | "d"'.
```

## æ€»ç»“

é˜…è¯» Vue3 æºç ï¼Œå¦‚æœä¸çŸ¥é“ ts çš„é«˜çº§ç”¨æ³•ï¼Œä½ å¯èƒ½ä¼šåˆ«ç»•æ™•ï¼›ä½†æ˜¯ï¼Œå¦‚æœä½ æ˜¯åˆæ¬¡é˜…è¯»æºç ï¼Œå»ºè®®åœ¨ç¤¾åŒºå†…æ‰¾ä¸€ä¸ªâ€œç®€å•â€ç‰ˆæœ¬å­¦ä¹ ï¼Œå’³å’³ï¼

ğŸ‘ğŸ‘ğŸ‘

æ¨èæºç é˜…è¯»ä» mini-vue å¼€å§‹ï¼š[gitHub ä»“åº“](https://github.com/cuixiaorui/mini-vue)ï¼Œå®ç°äº†æœ€ç®€çš„ Vue æ¨¡å‹ï¼
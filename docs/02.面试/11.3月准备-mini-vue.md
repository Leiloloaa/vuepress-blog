---
title: 3月准备-mini-vue
date: 2022-02-22 14:28:13
permalink: /pages/11c9ba/
categories:
  - 面试
tags:
  - 
---

# mini-vue

## 学习 mini-vue 带给你什么好处？

mini-vue 课程给我的最大好处有几点：

- 阅读源码不费劲 
- 代码能力提升 
- 扩展了知识系统

首先，mini-vue 是实现了 Vue3 的核心逻辑，除掉了繁琐的边缘情况，学完几节，你再去看源码，会发现，你好像会自动略过一些代码径直的找到核心的代码；其次，实现的过程中，你可以学到很多解决问题的艺术，称之为权衡的艺术，你可以这样实现也可以那样实现，但是由于考虑到性能以及维护性就要这样实现。还有如TPP这样的思想：先去实现特定行为，然后再重构成通用行为。这也是特性到共性的一种体现。再者，源码的学习会带给你一些底层的思维，如 diff 算法，为了让更新尽可能小，会先双端对比，然后再通过最长递增子序列，将改变达到最小。以上所说的你都能够在 mini-vue 的课程中学到，并且还可以生成自己的 mini-vue。 

## 说说响应式原理？

回答思路：

- 什么是响应式？
  - 响应式就是能够使数据变化可以被检测到并对这种变化做出响应机制
  - MVVM 框架中要解决的一个核心问题是连接数据层和视图层，通过数据驱动应用，数据变化，视图更新，要做到这一点就需要对数据响应式处理，这样数据一旦发生变化就可以立即做出更新处理
- Vue3 的响应式是怎么实现的？比 Vue2 有哪些优缺点？
  - Vue2 是利用 Object.defineProperty() 进行劫持
  - Object.defineProperty() 对于新增或者删除属性时不会触发响应，虽然提供了 Vue.set/delete 这样的 API 完善对象的响应，但还是不完美
  - Vue3 则是通过 es6 的 Proxy 实现数据的代理，Proxy 多达13种代理方法，能够解决 Vue2 中存在的技术债
  - Object.defineProperty() 是直接操作原始数据，而 Proxy 是返回了一个新的对象

mini-vue 呢去除了很多复杂的情况，例如针对 对象来说 没有去考虑 添加、增加和删除对 for...in 操作的影响，以及数组修改长度或间接的修改 length 触发响应式还有 set、map、WeakMap 和 WeakSet 的响应式，这些在 Vue 中都做了特定的处理，而 mini-vue 只实现了基本的对象响应式，并且没有考虑 for...in 的影响。

## 说一说你对声明式和命令式的理解

- 定义
- 例子

最直观的感受，声明式框架可以让我们直接调用封装好的 api 框架底层会帮我们去实现，而命令式框架则是要通过底层命令的方式去实现。

Vue 和 React 都是声明式框架，像 Jquery 去像是命令式框架

声明式框架可读性和可维护性会比较好，而命令式框架的性能会比较高，因为声明式框架相当于是套了一个壳

## 虚拟 dom

- 定义
- 场景 要在特定的环境下去讨论虚拟 dom 的性能
- 优劣
- 权衡艺术

构建上下文场景再说出虚拟 dom 和 操作 DOM

虚拟 dom 是指利用 js 对象去描述 dom，在用户更新的时候进行差异化更新。在性能方面，虚拟 dom 绝大多数要比直接操作 dom 性能要差，但是直接操作 dom 的心智负担会更重，可维护性不强。相较于使用 innerHTML 去更新模板，虚拟 dom 能够做到差异化更新，而 innerHTML 却只能全量替换，对于一些改动小的情况来说，性能就比较差了。不过总的来说，虚拟 dom 的优势还是比较明显，能获取较好的性能的同时，可读性和可维护性也比较好。

Vue3 的 虚拟 dom 限制在了组件级别，而 React 的虚拟 dom 是一颗大树。所以 React 需要 fiber，Vue3 则不需要。

## 运行时和编译时

运行时是指直接能够运行的代码，而编译时是需要通过编译器去解析然后才能运行。

## 说说 diff 算法？

diff 算法，在 Vue 中表示对比新老节点，找出最小差异进行更新。Vue3 的 diff 算法是采取了先双端对比，再通过最长递增子序列算法找出最小差异。

## watch 与 computed 的实现？

computed 和 watch 都是通过 effect 的第二个参数调度器传入不同的标识实现；

- computed 计算属性就是执行了一个副作用函数，通过 lazy 选项使得副作用函数可以懒执行。当计算属性依赖的响应式数据发生变化时，会通过 scheduler 将 dirty 标记为 true，代表“脏”，下次读取计算属性的值时，重新计算真正的值。
- watch 是利用副作用函数执行时的可调度性。一个 watch 本身会创建一个 effect，当这个 effect 依赖的响应式数据发生变化时，会执行该 effect 函数。通过 immediate 选项来实现

## 生命钩子函数有哪些？

**Vue**

Vue2 的生命钩子函数

beforeCreate -> created -> beforeMount -> mounted -> beforeUpdate -> updated -> beforeDestroy -> destroyed

Vue3 的生命钩子函数

setup -> onBeforeMount -> onMounted -> onBeforeUpdate -> onUpdated -> onBeforeUnmount -> onUnmounted

react 的生命钩子函数

componentDidMount
componentDidUpdate
componentWillUnmount

react hook 的生命钩子函数

useEffect 相当于 componentDidMount 和 componentWillUnmount

useEffect 的第二个参数
---
title: 3月准备-webpack&vite
date: 2022-02-12 09:17:17
permalink: /pages/ea6538/
categories:
  - 面试
tags:
  - 
---


# webpack&vite

## 说说你对 webpack 的看法

webpack 是一个用于现代 JavaScript 应用程序的静态模块(这里的静态模块指的是开发阶段，可以被 webpack 直接引用的资源)打包工具。

webpack 的能力

- 将 es6 => es5 解决兼容性问题，通过 babel
- 模块整合，将 js 文件放在同一个 bundle.js 下
- 万物都可打包，会有相应的 loader 进行打包

## webpack 的构建流程

- 初始化流程
  - 读取配置文件中的参数 
- 入口文件开始编译
- 根据配置文件中的 loader 去处理匹配的文件
- 得到处理后的文件，生成 ast 语法树
- 再处理依赖关系
- 输出文件

## Webpack 的打包原理是什么？

webpack 是一个现代 JavaScript 应用程序的静态模块打包器。当 webpack 处理应用程序时，它会递归地构建一个依赖关系图(dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle。

自己实现了一个 mini-webpack 80 多行代码

- 根据 文件 关系 生成 图 graph
  - 内容
  - 依赖关系
    - 通过 babel 的 traverse
- 然后再根据 图 生成 js
  - ejs 模板
  - 考虑重名与文件相对路径问题

## 什么是 loader，什么是 plugin？

webpack 默认只识别 js 文件，对于例如 json 格式的文件，我们需要用相应的 loader 去转换再形成 ast 语法树。而 plugin 是为了解决 loader 无法实现的事情，plugin 能提供特定的功能。

常用的 HtmlWebpackPlugin 插件：在打包结束后，⾃动生成⼀个 html ⽂文件，并把打包生成的 js 模块引⼊到该 html 中。

- loader 是文件加载器，能够加载资源文件，并对这些文件进行一些处理，诸如编译、压缩等，最终一起打包到指定的文件中
- plugin 赋予了 webpack 各种灵活的功能，例如打包优化、资源管理、环境变量注入等，目的是解决 loader 无法实现的其他事

**两者在运行时机上的区别：**

- loader 运行在打包文件之前
- plugins 在整个编译周期都起作用

在 Webpack 运行的生命周期中会广播出许多事件，Plugin 可以监听这些事件，在合适的时机通过Webpack提供的 API 改变输出结果。对于loader，实质是一个转换器，将A文件进行编译形成B文件，操作的是文件，比如将 A.scss 或 A.less 转变为 B.css，单纯的文件转换过程。

## 什么是热更新？有什么优点？

HMR 全称 Hot Module Replacement，可以理解为模块热替换，指在应用程序运行过程中，替换、添加、删除模块，而无需重新刷新整个应用。

例如，我们在应用运行过程中修改了某个模块，通过自动刷新会导致整个应用的整体刷新，那页面中的状态信息都会丢失。如果使用的是 HMR，就可以实现只将修改的模块实时替换至应用中，不必完全刷新整个应用。

**开启热更新**

```js
const webpack = require('webpack')
module.exports = {
  // ...
  devServer: {
    // 开启 HMR 特性
    hot: true
    // hotOnly: true
  }
}
```

## 如何借助 webpack 来优化前端性能？

通过webpack优化前端的手段有：

- **代码压缩**
  - JS代码压缩
  - CSS代码压缩
  - HTML文件代码压缩
- **文件大小压缩**
- **图片压缩**
- **Tree Shaking**
- **代码分离**
- **内联 chunk**

## 如何优化构建速度？